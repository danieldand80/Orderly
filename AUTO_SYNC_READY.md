# ‚úÖ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –ì–û–¢–û–í–ê!

---

## üéâ –ß–¢–û –°–î–ï–õ–ê–ù–û:

### **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Cron Job** (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤!)

```
üì¶ –¢–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Railway
  ‚îî‚îÄ ü§ñ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
      ‚îî‚îÄ ‚è∞ –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 UTC
          ‚îî‚îÄ üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```

---

## üöÄ –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢:

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
```
1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ Railway
2. –í–Ω—É—Ç—Ä–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (node-cron)
3. –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 —É—Ç—Ä–∞ UTC:
   - –ß–∏—Ç–∞–µ—Ç Google Sheets
   - –û–±–Ω–æ–≤–ª—è–µ—Ç Supabase
   - –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∑–∞–∫–∞–∑—ã (>4 –º–µ—Å—è—Ü–∞)
4. –¢—ã –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—à—å - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∞–º–æ! üòé
```

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤** - –≤—Å—ë –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** - –Ω–∞—Å—Ç—Ä–æ–∏–ª –æ–¥–∏–Ω —Ä–∞–∑, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ—á–Ω–æ
- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** - –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- ‚úÖ **–õ–æ–≥–∏ –≤ Railway** - –≤–∏–¥–∏—à—å –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ (Railway –≤—Å–µ–≥–¥–∞ –¥–µ—Ä–∂–∏—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã–º)

---

## üìã –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨: (2 –®–ê–ì–ê)

### **–®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** (1 –º–∏–Ω—É—Ç–∞)

–ó–∞–π–¥–∏ –≤ Supabase ‚Üí SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏:

```sql
ALTER TABLE orders ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW();
CREATE INDEX IF NOT EXISTS idx_orders_updated_at ON orders(updated_at);
```

---

### **–®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å SYNC_API_KEY –≤ Railway** (1 –º–∏–Ω—É—Ç–∞)

1. Railway ‚Üí **Variables** ‚Üí **New Variable**
2. –ò–º—è: `SYNC_API_KEY`
3. –ó–Ω–∞—á–µ–Ω–∏–µ: `–ª—é–±–∞—è_–¥–ª–∏–Ω–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞_12345` (–º–æ–∂–µ—à—å –ø—Ä–∏–¥—É–º–∞—Ç—å —Å–∞–º)
4. **Add**

---

## ‚úÖ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
- ‚è∞ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**
- üïê –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ **3:00 UTC** (6:00 Israel Time)
- üìä –õ–æ–≥–∏ –±—É–¥–µ—à—å –≤–∏–¥–µ—Ç—å –≤ Railway:

```
‚è∞ ===== SCHEDULED SYNC TRIGGERED =====
üìä Fetching orders from Google Sheets...
‚úÖ Found 150 rows
üíæ Upserting 150 orders to Supabase...
‚úÖ Upsert complete: 150 processed
üßπ Cleaning up old orders (>4 months)...
‚úÖ Deleted 5 old orders
‚úÖ Scheduled sync completed successfully
```

---

## üß™ –†–£–ß–ù–ê–Ø –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø (–¥–ª—è —Ç–µ—Å—Ç–æ–≤):

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å (–Ω–µ –∂–¥–∞—Ç—å –¥–æ 3:00):

**PowerShell:**
```powershell
$headers = @{ "x-api-key" = "—Ç–≤–æ–π_SYNC_API_KEY" }
Invoke-RestMethod -Uri "https://—Ç–≤–æ–π-app.up.railway.app/api/sync-orders" -Method POST -Headers $headers
```

**Bash:**
```bash
curl -X POST https://—Ç–≤–æ–π-app.up.railway.app/api/sync-orders \
  -H "x-api-key: —Ç–≤–æ–π_SYNC_API_KEY"
```

---

## üéØ –ò–¢–û–ì–û:

### **–†–∞–Ω—å—à–µ (–±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏):**
```
‚ùå –ö–∞–∂–¥—ã–π —Ä–∞–∑ –Ω—É–∂–Ω–æ –±—ã–ª–æ –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–ª—è—Ç—å –ë–î
‚ùå –°—Ç–∞—Ä—ã–µ –∑–∞–∫–∞–∑—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞–ª–∏—Å—å
‚ùå –¢—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –≤—Ä–µ–º—è –∏ –≤–Ω–∏–º–∞–Ω–∏–µ
```

### **–°–µ–π—á–∞—Å (—Å –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π):**
```
‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è
‚úÖ –°—Ç–∞—Ä—ã–µ –∑–∞–∫–∞–∑—ã —É–¥–∞–ª—è—é—Ç—Å—è —Å–∞–º–∏
‚úÖ –¢—ã –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—à—å
‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7
```

---

## üìñ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û:

- **–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** `SYNC_INSTRUCTIONS_RU.md`
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `backend/SYNC_SETUP.md`

---

## üî• –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. ‚úÖ **–°–µ–π—á–∞—Å:** –ò–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
2. ‚è≥ **–ñ–¥–µ–º:** Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç
3. üìã **–ü–æ—Ç–æ–º:** –í—ã–ø–æ–ª–Ω–∏ 2 —à–∞–≥–∞ –≤—ã—à–µ (SQL + SYNC_API_KEY)
4. üéâ **–ì–æ—Ç–æ–≤–æ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

---

**–ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –≤—Å—ë –≤–Ω—É—Ç—Ä–∏!** üöÄ

